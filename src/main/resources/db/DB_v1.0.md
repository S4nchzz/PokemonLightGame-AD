-- Crear base de dato
CREATE DATABASE POKEMON_LIGHTGAME_AD;
USE POKEMON_LIGHTGAME_AD;

-- Crear tabla LICENSE
CREATE TABLE LICENSE (
ID INT PRIMARY KEY,
EXPEDITION_DATE VARCHAR(10) NOT NULL,
POINTS FLOAT NOT NULL,
N_VICTORIES INT NOT NULL
);

-- Crear tabla TRAINER
CREATE TABLE TRAINER (
ID INT PRIMARY KEY AUTO_INCREMENT,
USERNAME VARCHAR(255) NOT NULL,
NAME VARCHAR(255) NOT NULL,
NATIONALITY VARCHAR(255) NOT NULL,
LICENSE_ID INT NOT NULL,
FOREIGN KEY (LICENSE_ID) REFERENCES LICENSE(ID),
UNIQUE(USERNAME)
);

-- Crear tabla TOURNAMENT
CREATE TABLE TOURNAMENT (
ID INT PRIMARY KEY AUTO_INCREMENT,
NAME VARCHAR(255) NOT NULL,
COD_REGION CHAR(1) NOT NULL,
VICTORY_POINTS FLOAT NOT NULL,
T_WINNER INT,
FOREIGN KEY (T_WINNER) REFERENCES TRAINER(ID)
);

-- Crear tabla TRAINER_ON_TOURNAMENT
CREATE TABLE TRAINER_ON_TOURNAMENT (
ID INT PRIMARY KEY AUTO_INCREMENT,
ID_TOURNAMENT INT NOT NULL,
ID_TRAINER INT NOT NULL,
FOREIGN KEY (ID_TOURNAMENT) REFERENCES TOURNAMENT(ID),
FOREIGN KEY (ID_TRAINER) REFERENCES TRAINER(ID)
);

-- Crear tabla COMBAT
CREATE TABLE COMBAT (
ID INT PRIMARY KEY AUTO_INCREMENT,
ID_TOURNAMENT INT NOT NULL,
DATE DATE NOT NULL,
TRAINER_1 INT NOT NULL,
TRAINER_2 INT NOT NULL,
C_WINNER INT,
FOREIGN KEY (ID_TOURNAMENT) REFERENCES TOURNAMENT(ID),
FOREIGN KEY (TRAINER_1) REFERENCES TRAINER(ID),
FOREIGN KEY (TRAINER_2) REFERENCES TRAINER(ID),
FOREIGN KEY (C_WINNER) REFERENCES TRAINER(ID)
);

CREATE TABLE AT_IN_TOURNAMENT (
ID INT PRIMARY KEY AUTO_INCREMENT,
USERNAME VARCHAR(255) NOT NULL,
TOURNAMENT_ID INT NOT NULL,
FOREIGN KEY (TOURNAMENT_ID) REFERENCES TOURNAMENT(ID),
UNIQUE(USERNAME)
);