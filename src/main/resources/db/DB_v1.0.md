-- Crear base de dato
CREATE DATABASE POKEMON_LIGHTGAME_AD;
USE POKEMON_LIGHTGAME_AD;

-- Crear tabla LICENSE
CREATE TABLE LICENSE (
ID INT PRIMARY KEY,
EXPEDITION_DATE VARCHAR(10) NOT NULL,
POINTS FLOAT NOT NULL,
N_VICTORIES INT NOT NULL
);

-- Crear tabla TRAINER
CREATE TABLE TRAINER (
ID INT PRIMARY KEY AUTO_INCREMENT,
USERNAME VARCHAR(255) NOT NULL,
NAME VARCHAR(255) NOT NULL,
NATIONALITY VARCHAR(255) NOT NULL,
LICENSE_ID INT NOT NULL,
FOREIGN KEY (LICENSE_ID) REFERENCES LICENSE(ID),
UNIQUE(USERNAME)
);

-- Crear tabla TOURNAMENT
CREATE TABLE TOURNAMENT (
ID INT PRIMARY KEY AUTO_INCREMENT,
NAME VARCHAR(255) NOT NULL,
COD_REGION CHAR(1) NOT NULL,
VICTORY_POINTS FLOAT NOT NULL,
T_WINNER INT,
FOREIGN KEY (T_WINNER) REFERENCES TRAINER(ID)
);

-- Crear tabla COMBAT
CREATE TABLE COMBAT (
ID INT PRIMARY KEY AUTO_INCREMENT,
TOURNAMENT_ID INT NOT NULL,
DATE VARCHAR(255),
TRAINER_1 INT,
TRAINER_2 INT,
C_WINNER INT,
FOREIGN KEY (TOURNAMENT_ID) REFERENCES TOURNAMENT(ID),
FOREIGN KEY (TRAINER_1) REFERENCES TRAINER(ID),
FOREIGN KEY (TRAINER_2) REFERENCES TRAINER(ID),
FOREIGN KEY (C_WINNER) REFERENCES TRAINER(ID)
);

-- Crear tabla AT_IN_TOURNAMENT
CREATE TABLE AT_IN_TOURNAMENT (
ID INT PRIMARY KEY AUTO_INCREMENT,
USERNAME VARCHAR(255) NOT NULL,
TOURNAMENT_ID INT NOT NULL,
FOREIGN KEY (TOURNAMENT_ID) REFERENCES TOURNAMENT(ID),
UNIQUE(USERNAME)
);

-- Crear tabla Join_tournament_request
CREATE TABLE JOIN_TOURNAMENT_REQUEST (
ID INT PRIMARY KEY AUTO_INCREMENT,
TRAINER_ID INT NOT NULL,
TOURNAMENT_ID INT NOT NULL,
FOREIGN KEY (TRAINER_ID) REFERENCES TRAINER(ID),
FOREIGN KEY (TOURNAMENT_ID) REFERENCES TOURNAMENT(ID)
);